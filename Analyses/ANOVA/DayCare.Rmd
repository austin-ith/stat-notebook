---
title: "Day Care Fines"
output: 
  html_document:
    theme: cerulean
    code_folding: hide
---

<script type="text/javascript">
 function showhide(id) {
    var e = document.getElementById(id);
    e.style.display = (e.style.display == 'block') ? 'none' : 'block';
 }
</script>

```{r, include=FALSE}
library(mosaic)
library(DT)
library(pander)
library(car)

# To get the "late" dataset into your R Console, 
# you need to go to your file menu of R-Studio and select
# "Session, Set working directory, To source file location"
# Then click the green "play" arrow in 
# the top right corner of this gray R-Chunk. 
late <- read.csv("../../Data/late.csv", header=TRUE)
# Then type:
# > View(late)
# in your R Console
```



----

<!--If you want to give your critiquers some ideas about what you have questions on and would like help with, place those details here.-->

**Comments to Critiquers:** 



<!--End your comments to your critiquers before this line.-->

----


## Background {.tabset .tabset-fade}

### Overview
<!-- Be sure to add your own background here before beginning the Analysis. -->

A study was performed looking at the number of students that were picked up late by parents. In a random selection of schools they imposed a fine for a number of weeks. They then removed the fine and continued to analyze the number of students that were picked up late. See "Study Details," and data tabs for more information. 

The data set thus provides us with 10 schools(randomly selected), 4 of which are in a control group and will have no changes made. The other 6 remaining schools will have a fine imposed. These two groups will make up a factor called "Treatment." Number of students at the school and number of students picked up late are recorded for each school for 20 weeks.

Our purpose is to analyze the interaction between Treatment, Time, and Number of students picked up late. 

<!--End your background before here.-->
<!--Click the little black arrow to 
the left to expand/hide these next sections.-->
### Study Details

<div style="color:#a8a8a8;">
This background is quoted directly from the article ["A Fine is a Price"](http://rady.ucsd.edu/faculty/directory/gneezy/pub/docs/fine.pdf). 
</div>

<div style="padding-left:30px; padding-right:30px;">

There are two types of day-care centers in Israel: private and public. A study was conducted in 10 private day-care centers in the city of Haifa from January to June 1998. All of these centers are located in the same part of town, and there is no important difference among them. During the day children are organized into groups according to age, from 1 to 4 years old. Each day-care center is allowed to hold a maximum of 35 children. In some exceptional cases a few additional children are allowed. The fee for each child is NIS 1,400 per month. (The NIS is the New Israeli Shekel.) At the time of the study, a U.S. dollar was worth approximately NIS 3.68, so the fee was about $380 at that time. 

The contract signed at the beginning of the year states that the day-care
center operates between 0730 and 1600. There is no mention of what happens if parents come late to pick up their children. In particular, before the beginning of the study, there was no fine for coming late. When parents did not come on time, one of the teachers had to wait with the children concerned. Teachers would rotate in this task, which is considered part of the job of a teacher, a fact that is clearly explained when a teacher is hired. Parents rarely came after 1630. 

A natural option [to fix the problem of parents showing up late] is to introduce a fine: every time a parent comes late, [they] will have to pay a fine. Will that reduce the number of parents who come late? If the fine is removed, will things revert back to the way they were originally?

The overall period of the study was 20 weeks. In the first 4 weeks we
simply recorded the number of parents who arrived late each week. At the
beginning of the fifth week, we introduced a fine in six of the 10 day-care centers, which had been selected randomly. The announcement of the fine was made with a note posted on the bulletin board of the day-care center. Parents tend to look at this board every day, since important announcements are posted there. The announcement specified that the fine would be NIS 10 for a delay of 10 minutes or more. The fine was per child; thus, if parents had two children in the center and they came late, they had to pay NIS 20. Payment was made to the principal of the day-care center at the end of the month. Since monthly payments are made to the owner during the year, the fines were added to those amounts. The money was paid to the owner, rather then to the teacher who was staying late (and did not get any additional money). The teachers were informed of the fine but not of the study. Registering the names of parents who came late was a common practice in any case.

At the beginning of the seventeenth week, the fine was removed with no explanation. Notice of the cancellation was posted on the board. If parents asked why the fines were removed, the principals were instructed to reply that the fine had been a trial for a limited time and that the results of this trial were now being evaluated.

A comparison with other fines in Israel may give an idea of the size of
the penalty that was introduced. A fine of NIS 10 is relatively small but not insignificant. In comparison, the fine for illegal parking is NIS 75; the fine for driving through a red light is NIS 1,000 plus penalties; the fine for not collecting the droppings of a dog is NIS 360. For many of these violations, however, detection and enforcement are low or, as in the case of dog dirt, nonexistent in practice. A baby-sitter earns between NIS 15 and NIS 20 per hour. The average gross salary per month in Israel at the time of the study was NIS 5,595.

</div>


### The Data (Wide)


The `late` Day Care Center data is shown here in the "wide data format". 

```{r, out.width=300}
#Show the full width of the "Wide" version of the late data:
pander(late, split.tables = Inf)
```


### The Data (Long)

The `Late` Day Care Center data is shown here in the "long data format".

```{r}
# This code reshapes the data into "long" format called Late.
# To get the "Late" dataset into your R Console, 
# you need to click the green "play" arrow in 
# the top right corner of this gray R-Chunk. 
# Then type:
#   > View(Late)
# in your R Console
Late <- reshape(late,
                varying = paste("Week",1:20, sep=""), 
                v.names = "No.ofLateChildren",
                timevar = "Week", 
                times = 1:20, 
                idvar = "Center",
                new.row.names = 1:200,
                direction = "long")
pander(Late)
```


 
##  
<!-- You can begin writing again after here.-->



## Analysis

The study breaks the weeks into three distinct groups that I will call collectively as Week groups. These groups will be Pre-Fine, Fine, and Post-Fine to represent with weeks before, during, and after the Fine was imposed. For reference, the fine was imposed between weeks 5 and 16 of the 20 week study. 

Using a Two-way ANOVA to study the interaction of Treatment, Week groups(Time), and number of students picked up late, we are going to ask three questions: 

1. Does `Treatment` affect the number of students picked up late?
Factor: `Treatment` with levels Control and Fine.

\[
H_0: \mu_{Control} = \mu_{Fine} = \mu
\]
\[
H_a: \mu_i \neq \mu \text{ for at least one }\ i \in\{1=Control,2=Fine\}
\]

2. Does `Week_group` affect the number of students picked up late?
Factor: `Week_group` with levels Pre-Fine, Fine, and Post-Fine.
\[
H_0: \mu_{Pre-Fine} = \mu_{Fine} = \mu_{Post-Fine} = \mu
\]
\[
H_a: \mu_i \neq \mu \text{ for at least one }\ i \in\{1=Pre-Fine,2=Fine,3=Post-Fine\}
\]

3. Does the effect of the `Week_group` change with the `Treatment` and vice-versa? Or rather, is there an interaction between the two factors?

\[
H_0: \text{The effect of week_group is the same for all treatment groups.}
\]
\[
H_a: \text{The effect of week_group is not the same for all treatment groups.}
\]

\[
H_a: \mu \neq \mu \text{ The effect of week_group is not the same for all treatment groups.}
\]

Note: This third question will be very informative, as it will plainly display the affect of students picked up late in relation to Weekgroups and Treatment. 

Our level of significance for these three questions will be:
$$
\alpha = 0.05
$$

Performing the ANOVA test we get the following results. 

```{r, comment=NA}
Late$Weekgroup <- cut(Late$Week, c(0,4,16,20), 
                      labels = c("Pre-Fine","Fine","Post-Fine"), 
                      ordered_result = TRUE)

late.aov <- aov(No.ofLateChildren ~ Treatment + Weekgroup + Treatment:Weekgroup, 
                data = Late)

pander(summary(late.aov))
```

From the summary table above, we find that all three p-values are below alpha. Therefore they are all significant factors, `Treatment` with $(p=4.92e^{-12}<0.05)$, `Weekgroup` with $(p=5.46e^{-6}<0.05)$, and the interaction between the two at $(p=4.16e^{-6}<0.05)$. Thus we will reject the null hypothesis to all three questions asked and accept the alternative hypothesis. 

To verify the accuracy of the ANOVA test we just perfomed, see the QQ-Plot and Residuals vs Fitted Values plot below. 

```{r}
par(mfrow=c(1,2))
plot(late.aov, which=1:2, pch=16)
```

The fitted Values plot shows us the variance in each group. We are trying to verify that the variance between groups is small as possible. In the graph show, as the groups move forward, their is slight variance but we'll consider this variance not substantial enough to consider the test invalid. 

The QQ-Plot shows the normality of the error terms. We check to see if the points are close to the dotted line shown. In this case, the data appears to be normal. 

The next three graphics show the results of the each test performed. 

```{r}
xyplot(No.ofLateChildren ~ Treatment,
       data = Late,
       type = c("p","a"),
       main = "Significance of Treatment",
       ylab = "Number of Children Picked Up Late",
       col = "red")
```

Note the significant increase of the Number of Children picked up late between the control group and the Fined group. This is counter-intuitive to the intended result that a fine would decrease the number of students picked up late. 

```{r}
xyplot(No.ofLateChildren ~ Weekgroup,
       data = Late,
       type = c("p","a"),
       main = "Significance of Weekgroup",
       ylab = "Number of Children Picked Up Late",
       col = "blue")
```

Note that the number of students picked up late increased with the fine and yet stayed constant after the fine was removed. 

```{r}
xyplot(No.ofLateChildren ~ Weekgroup,
       data = Late,
       groups = Treatment,
       type = c("p","a"),
       main = "Significance of Interaction",
       ylab = "Number of Children Picked Up Late",
       auto.key = list(corner = c(1,1)),
       col = c("red","blue"))
```

Note the stark diffence between the Control and Fined groups. It would appear that the number of students picked up late decreased during the same time the Fined group increased. 

```{r}


```

<h1>Interpretation<h1/>

Examine the data summary below.

```{r}
Late %>% 
  group_by(Weekgroup, Treatment) %>% 
  summarise(No.ofLateChildren = mean(No.ofLateChildren)) %>% 
  pander()
```

There are several conclusions that we can derive from this table and the ANOVA Test performed.

First, that the number of students picked up late by their parents significantly increased by an average of 8 students to 16.44 students with the introduction of the Fine. 

Second, that the while the introduction of the Fine increased the number of students picked up late from an average of 8 students to 16.44 students, the removal of the fine did not return the number of students picked up late to it original value. Rather it increased to an average of 18.71 students.

Third, we can confirm that the Fine did indeed have an effect on the number of students picked up late(averaging between 8-18.71 students), as the number of students picked up late stayed relatively constant at an average of 8.25-10 students in the control group through the same Pre-Fine, Fine, and Post Fine periods of Time. 

We can ultimately conclude that the introduction of the Fine was a negative experiment resulting in more students picked up late than before. A higher fine or potentially going the other direction with a reward would be an interesting study to further the experiment. 


```{r, include=FALSE}
# This code was run in the Console to get the desired means.
mean(No.ofLateChildren ~ Treatment, groups = Weekgroup, data = Late)
```







