---
title: "House Selling Prices"
output: 
  html_document:
    theme: cerulean
    code_folding: hide
---

## The Goal

To build a Regression Model from House Data that predicts it's selling price while meeting the following criteria:

 1. Having an Adjusted R-squared greater than 0.86 and a validation Adjusted R-squared greater than 0.83
 2. Creating a visualization of the model
 3. Creating a interpretation of the model

```{r, include = FALSE}
library(tidyverse)
library(caTools)
library(pander)

# Importing the dataset
houses <- read.csv('train.csv')
```

## Regression {.tabset}

### Exploring the Data

I took some time here to explore the data, creating factors and separating them out factors into individuals terms to see what stood out in a full regression. This pathway gave me an adjusted R-squared of 0.9367, however the validation was terrible. I then began to refine the model through a painful process of visualization and trial and error. A sample of my code during this process will be shown below. 

```{r show=FALSE}
# Wrangle the Data
houses$Street <- factor(houses$Street,
                       levels = levels(houses$Street), 
                       # ("Grvl" "Pave")
                       labels = c(1:nlevels(houses$Street)))

houses$MSZoning <- factor(houses$MSZoning,
                       levels = levels(houses$MSZoning), 
                       # "C (all)" "FV"      "RH"      "RL"      "RM"
                       labels = c(1:nlevels(houses$MSZoning)))

houses$LotConfig <- factor(houses$LotConfig,
                       levels = levels(houses$LotConfig), 
                       # "Corner"  "CulDSac" "FR2"     "FR3"     "Inside"
                       labels = c(1:nlevels(houses$LotConfig)))

houses$LotShape <- factor(houses$LotShape,
                       levels = levels(houses$LotShape), 
                       # "IR1" "IR2" "IR3" "Reg"
                       labels = c(1:nlevels(houses$LotShape)))

houses$Neighborhood <- factor(houses$Neighborhood,
                       levels = levels(houses$Neighborhood), 
                       # "Blmngtn" "Blueste" "BrDale"  "BrkSide" "ClearCr" "CollgCr" "Crawfor" "Edwards" "Gilbert" "IDOTRR"  "MeadowV" "Mitchel" "NAmes"   "NoRidge" "NPkVill" "NridgHt" "NWAmes"  "OldTown" "Sawyer"  "SawyerW" "Somerst" "StoneBr" "SWISU"   "Timber"  "Veenker"
                       labels = c(1:nlevels(houses$Neighborhood)))

houses$LandContour <- factor(houses$LandContour,
                       levels = levels(houses$LandContour), 
                       # "Bnk" "HLS" "Low" "Lvl"
                       labels = c(1:nlevels(houses$LandContour)))

houses$LandSlope <- factor(houses$LandSlope,
                       levels = levels(houses$LandSlope), 
                       # "Gtl" "Mod" "Sev"
                       labels = c(1:nlevels(houses$LandSlope)))

houses$Condition1 <- factor(houses$Condition1,
                       levels = levels(houses$Condition1), 
                       # "Artery" "Feedr"  "Norm"   "PosA"   "PosN"   "RRAe"   "RRAn"   "RRNe"   "RRNn"
                       labels = c(1:nlevels(houses$Condition1)))

houses$Condition2 <- factor(houses$Condition2,
                       levels = levels(houses$Condition2), 
                       # "Artery" "Feedr"  "Norm"   "PosA"   "PosN"   "RRAe"   "RRAn"   "RRNn"
                       labels = c(1:nlevels(houses$Condition2)))

houses$BldgType <- factor(houses$BldgType,
                       levels = levels(houses$BldgType), 
                       # "1Fam"   "2fmCon" "Duplex" "Twnhs"  "TwnhsE"
                       labels = c(1:nlevels(houses$BldgType)))

houses$HouseStyle <- factor(houses$HouseStyle,
                       levels = levels(houses$HouseStyle), 
                       # "1.5Fin" "1.5Unf" "1Story" "2.5Unf" "2Story" "SFoyer" "SLvl"
                       labels = c(1:nlevels(houses$HouseStyle)))

houses$RoofStyle <- factor(houses$RoofStyle,
                       levels = levels(houses$RoofStyle), 
                       # "Flat"    "Gable"   "Gambrel" "Hip"     "Mansard" "Shed" 
                       labels = c(1:nlevels(houses$RoofStyle)))

houses$RoofMatl <- factor(houses$RoofMatl,
                       levels = levels(houses$RoofMatl), 
                       # "CompShg" "Tar&Grv" "WdShake" "WdShngl"
                       labels = c(1:nlevels(houses$RoofMatl)))

houses$Exterior1st <- factor(houses$Exterior1st,
                       levels = levels(houses$Exterior1st), 
                       # "AsbShng" "AsphShn" "BrkComm" "BrkFace" "CBlock"  "CemntBd" "HdBoard" "MetalSd" "Plywood" "Stucco"  "VinylSd" "Wd Sdng" "WdShing"
                       labels = c(1:nlevels(houses$Exterior1st)))

houses$Exterior2nd <- factor(houses$Exterior2nd,
                       levels = levels(houses$Exterior2nd), 
                       # "AsbShng" "AsphShn" "Brk Cmn" "BrkFace" "CBlock"  "CmentBd" "HdBoard" "ImStucc" "MetalSd" "Other"   "Plywood" "Stone"   "Stucco"  "VinylSd" "Wd Sdng" "Wd Shng"
                       labels = c(1:nlevels(houses$Exterior2nd)))

houses$MasVnrType <- factor(houses$MasVnrType,
                       levels = levels(houses$MasVnrType), 
                       # "BrkCmn"  "BrkFace" "None"  "Stone" 
                       labels = c(1:nlevels(houses$MasVnrType)))

houses$ExterQual <- factor(houses$ExterQual,
                       levels = levels(houses$ExterQual), 
                       # "Ex" "Fa" "Gd" "TA"
                       labels = c(1:nlevels(houses$ExterQual)))

houses$ExterCond <- factor(houses$ExterCond,
                       levels = levels(houses$ExterCond), 
                       # "Ex" "Fa" "Gd" "Po" "TA"
                       labels = c(1:nlevels(houses$ExterCond)))

houses$BsmtQual <- factor(houses$BsmtQual,
                       levels = levels(houses$BsmtQual), 
                       # "Ex" "Fa" "Gd" "TA"
                       labels = c(1:nlevels(houses$BsmtQual)))

houses$BsmtCond <- factor(houses$BsmtCond,
                       levels = levels(houses$BsmtCond), 
                       # "Fa" "Gd" "Po" "TA"
                       labels = c(1:nlevels(houses$BsmtCond)))

houses$Foundation <- factor(houses$Foundation,
                       levels = levels(houses$Foundation), 
                       # "BrkTil" "CBlock" "PConc"  "Slab"   "Stone"  "Wood"
                       labels = c(1:nlevels(houses$Foundation)))

houses$BsmtExposure <- factor(houses$BsmtExposure,
                       levels = levels(houses$BsmtExposure), 
                       # "Av" "Gd" "Mn" "No"
                       labels = c(1:nlevels(houses$BsmtExposure)))

houses$BsmtFinType1 <- factor(houses$BsmtFinType1,
                       levels = levels(houses$BsmtFinType1), 
                       # "ALQ" "BLQ" "GLQ" "LwQ" "Rec" "Unf"
                       labels = c(1:nlevels(houses$BsmtFinType1)))

houses$BsmtFinType2 <- factor(houses$BsmtFinType2,
                       levels = levels(houses$BsmtFinType2), 
                       # "ALQ" "BLQ" "GLQ" "LwQ" "Rec" "Unf"
                       labels = c(1:nlevels(houses$BsmtFinType2)))

houses$Heating <- factor(houses$Heating,
                       levels = levels(houses$Heating), 
                       # "GasA" "GasW" "Grav" "Wall"
                       labels = c(1:nlevels(houses$Heating)))

houses$HeatingQC <- factor(houses$HeatingQC,
                       levels = levels(houses$HeatingQC), 
                       # "Ex" "Fa" "Gd" "Po" "TA"
                       labels = c(1:nlevels(houses$HeatingQC)))

houses$CentralAir <- factor(houses$CentralAir,
                       levels = levels(houses$CentralAir), 
                       # "N" "Y"
                       labels = c(1:nlevels(houses$CentralAir)))

houses$Electrical <- factor(houses$Electrical,
                       levels = levels(houses$Electrical), 
                       # "FuseA" "FuseF" "FuseP" "SBrkr"
                       labels = c(1:nlevels(houses$Electrical)))

houses$Alley <- as.character(houses$Alley)
houses$Alley <- replace_na(houses$Alley, "No alley access")
houses$Alley <- as.factor(houses$Alley)
houses$Alley <- factor(houses$Alley,
                       levels = levels(houses$Alley), 
                       # "Grvl" "Pave" "NA"
                       labels = c(1:nlevels(houses$Alley)))

houses$KitchenQual <- factor(houses$KitchenQual,
                       levels = levels(houses$KitchenQual), 
                       # "Ex" "Fa" "Gd" "TA"
                       labels = c(1:nlevels(houses$KitchenQual)))

houses$Functional <- factor(houses$Functional,
                       levels = levels(houses$Functional), 
                       # "Maj1" "Maj2" "Min1" "Min2" "Mod"  "Sev"  "Typ"
                       labels = c(1:nlevels(houses$Functional)))

houses$FireplaceQu <- as.character(houses$FireplaceQu)
houses$FireplaceQu <- replace_na(houses$FireplaceQu, "No Fireplace")
houses$FireplaceQu <- as.factor(houses$FireplaceQu)
houses$FireplaceQu <- factor(houses$FireplaceQu,
                       levels = levels(houses$FireplaceQu), 
                       # "Ex" "Fa" "Gd" "No Fireplace" "Po" "TA"
                       labels = c(1:nlevels(houses$FireplaceQu)))

houses$GarageType <- as.character(houses$GarageType)
houses$GarageType <- replace_na(houses$GarageType, "No Garage")
houses$GarageType <- as.factor(houses$GarageType)
houses$GarageType <- factor(houses$GarageType,
                       levels = levels(houses$GarageType), 
                       # "2Types"    "Attchd"    "Basment"   "BuiltIn"   "CarPort"   "Detchd"    "No Garage"
                       labels = c(1:nlevels(houses$GarageType)))

houses$GarageFinish <- as.character(houses$GarageFinish)
houses$GarageFinish <- replace_na(houses$GarageFinish, "No Garage")
houses$GarageFinish <- as.factor(houses$GarageFinish)
houses$GarageFinish <- factor(houses$GarageFinish,
                       levels = levels(houses$GarageFinish), 
                       # "Fin"       "No Garage" "RFn"       "Unf" 
                       labels = c(1:nlevels(houses$GarageFinish)))

houses$GarageQual <- as.character(houses$GarageQual)
houses$GarageQual <- replace_na(houses$GarageQual, "No Garage")
houses$GarageQual <- as.factor(houses$GarageQual)
houses$GarageQual <- factor(houses$GarageQual,
                       levels = levels(houses$GarageQual), 
                       # "Ex"        "Fa"        "Gd"        "No Garage" "Po"        "TA"  
                       labels = c(1:nlevels(houses$GarageQual)))

houses$GarageCond <- as.character(houses$GarageCond)
houses$GarageCond <- replace_na(houses$GarageCond, "No Garage")
houses$GarageCond <- as.factor(houses$GarageCond)
houses$GarageCond <- factor(houses$GarageCond,
                       levels = levels(houses$GarageCond), 
                       # "Ex"        "Fa"        "Gd"        "No Garage" "Po"        "TA"  
                       labels = c(1:nlevels(houses$GarageCond)))

houses$PavedDrive <- factor(houses$PavedDrive,
                       levels = levels(houses$PavedDrive), 
                       # "N" "P" "Y"
                       labels = c(1:nlevels(houses$PavedDrive)))

houses$PoolQC <- as.character(houses$PoolQC)
houses$PoolQC <- replace_na(houses$PoolQC, "No Pool")
houses$PoolQC <- as.factor(houses$PoolQC)
houses$PoolQC <- factor(houses$PoolQC,
                       levels = levels(houses$PoolQC), 
                       # ""Ex"      "Fa"      "Gd"      "No Pool"
                       labels = c(1:nlevels(houses$PoolQC)))

houses$Fence <- as.character(houses$Fence)
houses$Fence <- replace_na(houses$Fence, "No Fence")
houses$Fence <- as.factor(houses$Fence)
houses$Fence <- factor(houses$Fence,
                       levels = levels(houses$Fence), 
                       # "GdPrv"    "GdWo"     "MnPrv"    "MnWw"     "No Fence"
                       labels = c(1:nlevels(houses$Fence)))

houses$MiscFeature <- as.character(houses$MiscFeature)
houses$MiscFeature <- replace_na(houses$MiscFeature, "No MISC")
houses$MiscFeature <- as.factor(houses$MiscFeature)
houses$MiscFeature <- factor(houses$MiscFeature,
                       levels = levels(houses$MiscFeature), 
                       # "Gar2"    "No MISC" "Othr"    "Shed"    "TenC"
                       labels = c(1:nlevels(houses$MiscFeature)))

houses$SaleType <- factor(houses$SaleType,
                       levels = levels(houses$SaleType), 
                       # COD"   "Con"   "ConLD" "ConLI" "ConLw" "CWD"   "New"   "Oth"   "WD" 
                       labels = c(1:nlevels(houses$SaleType)))

houses$SaleCondition <- factor(houses$SaleCondition,
                       levels = levels(houses$SaleCondition), 
                       # "Abnorml" "AdjLand" "Alloca"  "Family"  "Normal"  "Partial"
                       labels = c(1:nlevels(houses$SaleCondition)))

houses$Utilities <- factor(houses$Utilities,
                       levels = levels(houses$Utilities), 
                       # "AllPub" "NoSeWa"
                       labels = c(1:nlevels(houses$Utilities)))

houses <- houses[, !names(houses) %in% c("Utilities", "Id")] 

houses1 <- houses %>% 
  mutate(
    CmentBd = case_when(
    Exterior2nd == 6 ~ 1,
    TRUE ~ 0),
    Stone_Foundation = case_when(
    Foundation %in% 5 ~ 1,
    TRUE ~ 0),
    Wood_Foundation = case_when(
    Foundation %in% 6 ~ 1,
    TRUE ~ 0),
    Typ_Functional = case_when(
    Functional %in% 7 ~ 1,
    TRUE ~ 0),
    HeatingQC_Gd = case_when(
    HeatingQC %in% 3 ~ 1,
    TRUE ~ 0),
    HeatingQC_Ta = case_when(
    HeatingQC %in% 5 ~ 1,
    TRUE ~ 0),
    LotConfig_CulDSac = case_when(
    LotConfig %in% 2 ~ 1,
    TRUE ~ 0),
    SaleType_ConLD = case_when(
    SaleType %in% 3 ~ 1,
    TRUE ~ 0),
    Exterior1st_AsbShng = case_when(
    Exterior1st %in% 1 ~ 1,
    TRUE ~ 0),
    Exterior1st_BrkComm = case_when(
    Exterior1st %in% 3 ~ 1,
    TRUE ~ 0),
    Exterior1st_BrkFace = case_when(
    Exterior1st %in% 4 ~ 1,
    TRUE ~ 0),
    Exterior1st_CemntBd = case_when(
    Exterior1st %in% 6 ~ 1,
    TRUE ~ 0),
    Exterior1st_ImStucc = case_when(
    Exterior1st %in% 7 ~ 1,
    TRUE ~ 0),
    Exterior1st_Plywood = case_when(
    Exterior1st %in% 10 ~ 1,
    TRUE ~ 0),
    SaleCondition_Abnormal = case_when(
    SaleCondition %in% 1 ~ 1,
    TRUE ~ 0),
    SaleCondition_Alloca = case_when(
    SaleCondition %in% 3 ~ 1,
    TRUE ~ 0),
    SaleCondition_Family = case_when(
    SaleCondition %in% 4 ~ 1,
    TRUE ~ 0),
    SaleCondition_Normal = case_when(
    SaleCondition %in% 5 ~ 1,
    TRUE ~ 0),
    Neighborhood3 = case_when(
    Neighborhood %in% 3 ~ 1,
    TRUE ~ 0),
    Neighborhood4 = case_when(
    Neighborhood %in% 4 ~ 1,
    TRUE ~ 0),
    Neighborhood7 = case_when(
    Neighborhood %in% 7 ~ 1,
    TRUE ~ 0),
    Neighborhood8 = case_when(
    Neighborhood %in% 8 ~ 1,
    TRUE ~ 0),
    Neighborhood11 = case_when(
    Neighborhood %in% 11 ~ 1,
    TRUE ~ 0),
    Neighborhood16 = case_when(
    Neighborhood %in% 16 ~ 1,
    TRUE ~ 0),
    Neighborhood22 = case_when(
    Neighborhood %in% 22 ~ 1,
    TRUE ~ 0),
    Condition1_Artery = case_when(
    Condition1 %in% 1 ~ 1,
    TRUE ~ 0),
    Condition1_Feedr = case_when(
    Condition1 %in% 2 ~ 1,
    TRUE ~ 0),
    Condition1_RRAe = case_when(
    Condition1 %in% 6 ~ 1,
    TRUE ~ 0),
    Condition2_Norm = case_when(
    Condition2 %in% 3 ~ 1,
    TRUE ~ 0),
    Condition2_PosA = case_when(
    Condition2 %in% 4 ~ 1,
    TRUE ~ 0),
    Condition2_PosN = case_when(
    Condition2 %in% 5 ~ 1,
    TRUE ~ 0),
    RoofMatl = cut(as.numeric(as.character(RoofMatl)), c(0,7,8), labels = c("G1","G2")),
    MSZoning = as.factor(case_when(
      MSZoning %in% c(2,4) ~ 2,
      MSZoning %in% c(3,5) ~ 3,
      TRUE ~ as.numeric(MSZoning))
    )
    )
```

#### My Starting Point

```{r}

# Split the dataset into the Training set and Test set
set.seed(265)
split <- sample.split(houses1$SalePrice, SplitRatio = .8)
training_set <- subset(houses1, split == TRUE)
test_set <- subset(houses1, split == FALSE)
```

```{r}
summary(lm(log(SalePrice) ~ ., data = training_set))
```

While I have a good Adjusted R-squared with this intense model containing everything. There is no way a validation of this model will work. After whittling things down a bit, I get the following model:

```{r}

regressor2 <- lm(log(SalePrice) ~ MSZoning + OverallCond + X2ndFlrSF + Condition2 + BsmtFinSF1 + CentralAir + LotArea + Neighborhood + SaleCondition + ScreenPorch + KitchenQual + LandSlope + Exterior1st + BsmtFullBath + SaleType + LotConfig + BsmtUnfSF + YearBuilt + HeatingQC + GarageArea + GarageQual + Functional + Foundation + BsmtFinSF2 + WoodDeckSF + GarageCars + X3SsnPorch + HalfBath + YearRemodAdd + OverallQual:I(X1stFlrSF^2) + OverallQual:I(X1stFlrSF^3), data = training_set)

summary(regressor2)

```

Not bad, still have an high-ish adjusted R-squared at 0.9303. However the validation comes out as follows.

```{r}

y_pred <- exp(predict(regressor2, newdata = test_set))

test_set2 <- cbind(test_set, y_pred) %>% 
  select(SalePrice, y_pred)

ybar <- mean(test_set2$SalePrice)
SSTO <- sum( (test_set2$SalePrice - ybar)^2 )
SSE <- sum( (test_set2$SalePrice - test_set2$y_pred)^2 )
rs <- 1 - SSE/SSTO
n <- length(test_set2$SalePrice)
p <- length(coef(regressor2))
rsa <- 1 - (n-1)/(n-p)*SSE/SSTO
 
```

| Validation | $R^2$ | Adjusted $R^2$ |
|------------|-------|----------------|
| Model | `r rs` | `r rsa` |

So that wasn't too good...

I decided to look at a bunch of different variables.

<center>
```{r}

  # Starting with Exterior2nd. 
  # The factors are "AsbShng" "AsphShn" "Brk Cmn" "BrkFace" "CBlock"  "CmentBd" "HdBoard" "ImStucc" "MetalSd" "Plywood" "Stone"   "Stucco"  "VinylSd" "Wd Sdng" "Wd Shng"

plot(SalePrice ~ Exterior2nd, data = houses)

houses %>%
  group_by(Exterior2nd) %>%
  summarize(MedianSale = median(SalePrice)) %>%
  arrange(MedianSale) %>% 
  pander()

# Moving on to Foundation. 
# The factors are "BrkTil" "CBlock" "PConc"  "Slab"   "Stone"  "Wood"

plot(SalePrice ~ Foundation, data = houses)

houses %>% 
  group_by(Foundation) %>% 
  summarize(MedianSale = median(SalePrice)) %>% 
  arrange(MedianSale) %>% 
  pander()

# Moving on to Functional 
# The factors are "Maj1" "Maj2" "Min1" "Min2" "Mod"  "Sev"  "Typ"

plot(SalePrice ~ Functional, data = houses)

houses %>% 
  group_by(Functional) %>% 
  summarize(MedianSale = median(SalePrice)) %>% 
  arrange(MedianSale) %>% 
  pander()

# Moving on to HeatingQC 
# The factors are "Ex" "Fa" "Gd" "Po" "TA"

plot(SalePrice ~ HeatingQC, data = houses)

houses %>% 
  group_by(HeatingQC) %>% 
  summarize(MedianSale = median(SalePrice)) %>% 
  arrange(MedianSale) %>% 
  pander()

# Moving on to LotConfig
# The factors are "Corner"  "CulDSac" "FR2"     "FR3"     "Inside"

plot(SalePrice ~ LotConfig, data = houses)

houses %>% 
  group_by(LotConfig) %>% 
  summarize(MedianSale = median(SalePrice)) %>% 
  arrange(MedianSale) %>% 
  pander()

# Moving on to SaleType
# The factors are "COD"   "Con"   "ConLD" "ConLI" "ConLw" "CWD"   "New"   "Oth"   "WD"

plot(SalePrice ~ SaleType, data = houses)

houses %>% 
  group_by(SaleType) %>% 
  summarize(MedianSale = median(SalePrice)) %>% 
  arrange(MedianSale) %>% 
  pander()

# Moving on to Exterior1st
# The factors are "AsbShng" "AsphShn" "Brk Cmn" "BrkFace" "CBlock"  "CmentBd" "HdBoard" "ImStucc" "MetalSd" "Other"   "Plywood" "Stone"   "Stucco"  "VinylSd" "WdSdng" "WdShng"

plot(SalePrice ~ Exterior1st, data = houses)

houses %>% 
  group_by(Exterior1st) %>% 
  summarize(MedianSale = median(SalePrice)) %>% 
  arrange(MedianSale) %>% 
  pander()

# Moving on to SaleCondition
# The factors are "Abnorml" "AdjLand" "Alloca"  "Family"  "Normal"  "Partial"

plot(SalePrice ~ SaleCondition, data = houses)

houses %>% 
  group_by(SaleCondition) %>% 
  summarize(MedianSale = median(SalePrice)) %>% 
  arrange(MedianSale) %>% 
  pander()

# Moving on to Neighborhood
# The factors are "Blmngtn" "Blueste" "BrDale"  "BrkSide" "ClearCr" "CollgCr" "Crawfor" "Edwards" "Gilbert" "IDOTRR"  "MeadowV" "Mitchel" "NAmes"   "NoRidge" "NPkVill" "NridgHt" "NWAmes"  "OldTown" "Sawyer"  "SawyerW" "Somerst" "StoneBr" "SWISU"   "Timber"  "Veenker"

plot(SalePrice ~ Neighborhood, data = houses)

houses %>% 
  group_by(Neighborhood) %>% 
  summarize(MedianSale = median(SalePrice)) %>% 
  arrange(MedianSale) %>% 
  pander()

# Moving on to Condition1
# The factors are "Artery" "Feedr"  "Norm"   "PosA"   "PosN"   "RRAe"   "RRAn"   "RRNe"   "RRNn"

plot(SalePrice ~ Condition1, data = houses)

houses %>% 
  group_by(Condition1) %>% 
  summarize(MedianSale = median(SalePrice)) %>% 
  arrange(MedianSale) %>% 
  pander()

# Moving on to Condition2
# The factors are "Artery" "Feedr"  "Norm"   "PosA"   "PosN"   "RRAe"   "RRAn"   "RRNn"

plot(SalePrice ~ Condition2, data = houses)

houses %>% 
  group_by(Condition2) %>% 
  summarize(MedianSale = median(SalePrice)) %>% 
  arrange(MedianSale) %>% 
  pander()

```
</center>

Deciding that things were getting a little too sticky to show graphically and to interpret. I've decided to take different components learned in my model, graphs, and tables above. See "Chosen Model" and "Graphical Support" tabs for the model that I settled into, its Adjusted R-squared/validation, and it's supporting graphs.

\

\

### Chosen Model

#### The  Model

The model that I have chosen is the following. 

```{r}
# training_set <- training_set %>% 
#   mutate(BsmtQual = replace_na(BsmtQual,"3"))

# which(rownames(training_set) %in% c(31, 496, 524))

regressor3 <- lm(log(SalePrice) ~ X2ndFlrSF + BsmtFinSF1 + CentralAir + LotArea + BsmtUnfSF + YearBuilt + HeatingQC_Ta + GarageArea + OverallQual:I(X1stFlrSF^2) + OverallCond:I(X1stFlrSF^2) + Fireplaces + OverallQual:X1stFlrSF, data = training_set)

summary(regressor3) 
b <- regressor3$coefficients
```

Let take a quick look at the Residuals vs Fitted Plot. 

```{r}

plot(regressor3, which = 1)

```


Things look good here. A few outliers, but they don't seem to affect things very much. 

#### The Validation

The following Table gives the validation of the above model.

```{r}
#apply(test_set1, 2, function(x) sum(is.na(x)))

# test_set <- test_set %>% 
#   mutate(BsmtQual = replace_na(BsmtQual,"3"))

y_pred <- exp(predict(regressor3, newdata = test_set))

test_set2 <- cbind(test_set, y_pred) %>% 
  select(SalePrice, y_pred)

ybar <- mean(test_set2$SalePrice)
SSTO <- sum( (test_set2$SalePrice - ybar)^2 )
SSE <- sum( (test_set2$SalePrice - test_set2$y_pred)^2 )
rs <- 1 - SSE/SSTO
n <- length(test_set2$SalePrice)
p <- length(coef(regressor3))
rsa <- 1 - (n-1)/(n-p)*SSE/SSTO

```


| Validation | $R^2$ | Adjusted $R^2$ |
|---------|-------|----------------|
| Model | `r rs` | `r rsa` |

\

\

\

### Graphical Support

Alright, here we go. The pair plot below gives us a starting point to begin looking at how each of the variables chosen in my model look against each other, but especially against the SalesPrice. 

```{r}
pairs(training_set[,c("SalePrice", "BsmtUnfSF", "BsmtFinSF1", "X1stFlrSF", "X2ndFlrSF", "LotArea", "GarageArea", "YearBuilt", "HeatingQC_Ta", "CentralAir", "Fireplaces", "OverallCond", "OverallQual")], panel=panel.smooth)
```

I'd like to note that while most of these variables clearly show a correlation, there are some that aren't as visible in the pairs plot but will be shown more clearly in the plots below. 

```{r warning=FALSE}

training_set %>% 
  select(BsmtUnfSF, BsmtFinSF1, X1stFlrSF, X2ndFlrSF, LotArea, GarageArea, YearBuilt, Fireplaces, OverallQual, OverallCond) %>% 
  summarise_each(funs(min = min,
                      q25 = quantile(., 0.25),
                      median = median, 
                      q75 = quantile(., 0.75), 
                      max = max,
                      mean = mean)) %>% 
  gather(stat, val) %>%
  separate(stat, into = c("var", "stat"), sep = "_") %>%
  spread(stat, val) %>%
  select(var, min, q25, median, q75, max, mean) %>% 
  pander()

```

#### 

```{r}
plot(SalePrice ~ X1stFlrSF, data=training_set, col=as.factor(Fireplaces))

BsmtFinSF1=0;X1stFlrSF=882;X2ndFlrSF=0;LotArea=7579;GarageArea=336;YearBuilt=1953;
CentralAir2=0;Fireplaces=0;HeatingQC_Ta=0;OverallQual=5;OverallCond=5;

curve(exp(b[1] + b[2]*X2ndFlrSF + b[3]*BsmtFinSF1 + b[4]*CentralAir2 + b[5]*LotArea + b[6]*BsmtUnfSF + b[7]*YearBuilt + b[8]*HeatingQC_Ta + b[9]*GarageArea + b[10]*Fireplaces + b[11]*OverallQual*X1stFlrSF^2 + b[12]*OverallCond*X1stFlrSF^2 + b[13]*OverallQual*X1stFlrSF), add=TRUE, xname="BsmtUnfSF", col=palette()[1])

BsmtFinSF1=716;X1stFlrSF=1414;X2ndFlrSF=741;LotArea=11614;GarageArea=578;YearBuilt=2001;
CentralAir2=1;Fireplaces=1;HeatingQC_Ta=1;OverallQual=7;OverallCond=6;
curve(exp(b[1] + b[2]*X2ndFlrSF + b[3]*BsmtFinSF1 + b[4]*CentralAir2 + b[5]*LotArea + b[6]*BsmtUnfSF + b[7]*YearBuilt + b[8]*HeatingQC_Ta + b[9]*GarageArea + b[10]*Fireplaces + b[11]*OverallQual*X1stFlrSF^2 + b[12]*OverallCond*X1stFlrSF^2 + b[13]*OverallQual*X1stFlrSF), add=TRUE, xname="BsmtUnfSF", col=palette()[2])

BsmtFinSF1=716;X1stFlrSF=4692;X2ndFlrSF=2065;LotArea=11614;GarageArea=1418;YearBuilt=2010;
CentralAir2=1;Fireplaces=2;HeatingQC_Ta=1;OverallQual=10;OverallCond=9;
curve(exp(b[1] + b[2]*X2ndFlrSF + b[3]*BsmtFinSF1 + b[4]*CentralAir2 + b[5]*LotArea + b[6]*BsmtUnfSF + b[7]*YearBuilt + b[8]*HeatingQC_Ta + b[9]*GarageArea + b[10]*Fireplaces + b[11]*OverallQual*X1stFlrSF^2 + b[12]*OverallCond*X1stFlrSF^2 + b[13]*OverallQual*X1stFlrSF), add=TRUE, xname="BsmtUnfSF", col=palette()[3])


```

```{r}
par(mfrow=c(1,3))

plot(regressor3, which=c(1,4,5))
```

It would appear that point 524 is an outlier and could be removed from the regression.

### Interpretation

















