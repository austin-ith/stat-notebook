---
title: "Regression Battleship - Final Guess"
author: "Austin Ith"
output: 
  html_document:
    theme: cerulean
    toc: true
    toc_float: true
    code_folding: hide
---

```{r}
library(pander)
library(tidyverse)
# Read in the RBdata here:
rbdata <- read.csv("saunders_Winter20_RBdata.csv", header=TRUE)
```



```{r}
pairs(rbdata, panel = panel.smooth)

lm4 <- lm(Y~X5 + X6, data = rbdata)
summary(lm4)
pairs(cbind(R=lm4$res, Fit = lm4$fit, rbdata), panel = panel.smooth, col = interaction(rbdata$X5, rbdata$X6))
```



```{r}
lm4 <- lm(Y~ X3 + X5 + X3:X5 + X6 + I(X3^2):X5 + X3:X8 + X3:X9, data = rbdata)
summary(lm4)
pairs(cbind(R=lm4$res, Fit = lm4$fit, rbdata), panel = panel.smooth, col = interaction(rbdata$X6, rbdata$X8))

```

Don't like how this one drew. Missing something

## Messed with things for a bit and arrived here


```{r}
######
lm4 <- lm(Y~X3 + X5 +X3:X5 + X6 + I(X3^2):X5 + X3:X9+ I(X3^2):X8 + I(X3^3):X8 + I(X3^3):X6 + I(X3^3):X9, data = rbdata)
summary(lm4)
pairs(cbind(R=lm4$res, Fit = lm4$fit, rbdata), panel = panel.smooth)
plot(lm4, which =1)


#####
```



## The Model of your Guess

<!-- Enter your guessed model in the math notation below. -->

$$
  Y_i = \beta_0 + \beta_1X_3 + \beta_2X_5 + \beta_3X_3X_5 +\beta_4X_3^2X_5 + \beta_5X_6 + \beta_6X_3^3X_6 + \beta_7X_3^2X_8 + \beta_8X_3^3X_8+ \beta_9X_3X_9 + \beta_10X_3^3X_9 + \epsilon_i
$$

## The lm(...) of your Guess

<!-- Provide your estimates of each model coefficient along with the Adjusted R-squared of your model:-->

```{r}
## Input your lm(Y ~ ... ,data=rbdata)
final.lm <- lm(Y~X3 + X5 +X3:X5 + X6 + I(X3^2):X5 + X3:X9+ I(X3^2):X8 + I(X3^3):X8 + I(X3^3):X6 + I(X3^3):X9, data=rbdata) #replace the "1" with your model
```

```{r}
###################################################################
#Don't edit this part:
pander(summary(final.lm)$coefficients)
```

**Adjusted R-squared**: `r summary(final.lm)$adj.r.squared`


## The Plot of your Guess

```{r}
b <- lm4$coefficients

plot(Y~X3, rbdata)
X5 = 0
X6 = 0
X8 = 0
X9 = 0
curve(b[1] + b[2]*x + b[3]*X5 + b[5]*X5*x + b[6]*X5*x^2 + b[4]*X6 + b[7]*X9*x + b[8]*x^2*X8 + b[9]*x^3*X8 + b[10]*x^3*X6 + b[11]*x^3*X9, add = T, col=palette()[1])
X5 = 1
X6 = 0
X8 = 0
X9 = 0
curve(b[1] + b[2]*x + b[3]*X5 + b[5]*X5*x + b[6]*X5*x^2 + b[4]*X6 + b[7]*X9*x + b[8]*x^2*X8 + b[9]*x^3*X8 + b[10]*x^3*X6 + b[11]*x^3*X9, add = T, col=palette()[2])
X5 = 0
X6 = 1
X8 = 0
X9 = 0
curve(b[1] + b[2]*x + b[3]*X5 + b[5]*X5*x + b[6]*X5*x^2 + b[4]*X6 + b[7]*X9*x + b[8]*x^2*X8 + b[9]*x^3*X8 + b[10]*x^3*X6 + b[11]*x^3*X9, add = T, col=palette()[3])
X5 = 1
X6 = 0
X8 = 1
X9 = 0
curve(b[1] + b[2]*x + b[3]*X5 + b[5]*X5*x + b[6]*X5*x^2 + b[4]*X6 + b[7]*X9*x + b[8]*x^2*X8 + b[9]*x^3*X8 + b[10]*x^3*X6 + b[11]*x^3*X9, add = T, col=palette()[4])
X5 = 1
X6 = 0
X8 = 1
X9 = 1
curve(b[1] + b[2]*x + b[3]*X5 + b[5]*X5*x + b[6]*X5*x^2 + b[4]*X6 + b[7]*X9*x + b[8]*x^2*X8 + b[9]*x^3*X8 + b[10]*x^3*X6 + b[11]*x^3*X9, add = T, col=palette()[5])

levels(droplevels(interaction(rbdata$X5,rbdata$X6,rbdata$X8,rbdata$X9)))

```






 

 

 

 